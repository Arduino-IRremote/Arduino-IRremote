<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>IRremote: src/irPronto.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">IRremote
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">irPronto.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="irPronto_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno"><a class="line" href="irPronto_8cpp.html#ab946e2e7f7679350627acfded8e2658b">    1</a></span>&#160;<span class="preprocessor">#define TEST 0</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160; </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#if TEST</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#   define SEND_PRONTO        1</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#   define PRONTO_ONCE        false</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#   define PRONTO_REPEAT      true</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#   define PRONTO_FALLBACK    true</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#   define PRONTO_NOFALLBACK  false</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160; </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#if SEND_PRONTO</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//******************************************************************************</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#if TEST</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#   include &lt;stdio.h&gt;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <span class="keywordtype">void</span>  enableIROut (<span class="keywordtype">int</span> freq)  { printf(<span class="stringliteral">&quot;\nFreq = %d KHz\n&quot;</span>, freq); }</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <span class="keywordtype">void</span>  mark        (<span class="keywordtype">int</span> t)     { printf(<span class="stringliteral">&quot;+%d,&quot;</span> , t); }</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <span class="keywordtype">void</span>  space       (<span class="keywordtype">int</span> t)     { printf(<span class="stringliteral">&quot;-%d, &quot;</span>, t); }</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#   include &quot;<a class="code" href="IRremote_8h.html">IRremote.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#endif // TEST</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//+=============================================================================</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">// Check for a valid hex digit</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="keywordtype">bool</span>  ishex (<span class="keywordtype">char</span> ch)</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;{</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keywordflow">return</span> ( ((ch &gt;= <span class="charliteral">&#39;0&#39;</span>) &amp;&amp; (ch &lt;= <span class="charliteral">&#39;9&#39;</span>)) ||</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;             ((ch &gt;= <span class="charliteral">&#39;A&#39;</span>) &amp;&amp; (ch &lt;= <span class="charliteral">&#39;F&#39;</span>)) ||</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;             ((ch &gt;= <span class="charliteral">&#39;a&#39;</span>) &amp;&amp; (ch &lt;= <span class="charliteral">&#39;f&#39;</span>))   ) ? true : false ;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;}</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">//+=============================================================================</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">// Check for a valid &quot;blank&quot; ... &#39;\0&#39; is a valid &quot;blank&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="keywordtype">bool</span>  isblank (<span class="keywordtype">char</span> ch)</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;{</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keywordflow">return</span> ((ch == <span class="charliteral">&#39; &#39;</span>) || (ch == <span class="charliteral">&#39;\t&#39;</span>) || (ch == <span class="charliteral">&#39;\0&#39;</span>)) ? true : false ;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;}</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">//+=============================================================================</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">// Bypass spaces</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="keywordtype">bool</span>  byp (<span class="keywordtype">char</span>** pcp)</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;{</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordflow">while</span> (isblank(**pcp))  (*pcp)++ ;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;}</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">//+=============================================================================</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">// Hex-to-Byte : Decode a hex digit</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">// We assume the character has already been validated</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;uint8_t  htob (<span class="keywordtype">char</span> ch)</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;{</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordflow">if</span> ((ch &gt;= <span class="charliteral">&#39;0&#39;</span>) &amp;&amp; (ch &lt;= <span class="charliteral">&#39;9&#39;</span>))  <span class="keywordflow">return</span> ch - <span class="charliteral">&#39;0&#39;</span> ;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordflow">if</span> ((ch &gt;= <span class="charliteral">&#39;A&#39;</span>) &amp;&amp; (ch &lt;= <span class="charliteral">&#39;F&#39;</span>))  <span class="keywordflow">return</span> ch - <span class="charliteral">&#39;A&#39;</span> + 10 ;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordflow">if</span> ((ch &gt;= <span class="charliteral">&#39;a&#39;</span>) &amp;&amp; (ch &lt;= <span class="charliteral">&#39;f&#39;</span>))  <span class="keywordflow">return</span> ch - <span class="charliteral">&#39;a&#39;</span> + 10 ;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;}</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">//+=============================================================================</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">// Hex-to-Word : Decode a block of 4 hex digits</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">// We assume the string has already been validated</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">//   and the pointer being passed points at the start of a block of 4 hex digits</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;uint16_t  htow (<span class="keywordtype">char</span>* cp)</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;{</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordflow">return</span> ( (htob(cp[0]) &lt;&lt; 12) | (htob(cp[1]) &lt;&lt;  8) |</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;             (htob(cp[2]) &lt;&lt;  4) | (htob(cp[3])      )  ) ;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;}</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">//+=============================================================================</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="keywordtype">bool</span> sendPronto (<span class="keywordtype">char</span>* s,  <span class="keywordtype">bool</span> repeat,  <span class="keywordtype">bool</span> fallback)</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;{</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordtype">int</span>       i;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordtype">int</span>       len;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordtype">int</span>       skip;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordtype">char</span>*     cp;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    uint16_t  freq;  <span class="comment">// Frequency in KHz</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    uint8_t   usec;  <span class="comment">// pronto uSec/tick</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    uint8_t   once;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    uint8_t   rpt;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="comment">// Validate the string</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordflow">for</span> (cp = s;  *cp;  cp += 4) {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        byp(&amp;cp);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <span class="keywordflow">if</span> ( !ishex(cp[0]) || !ishex(cp[1]) ||</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;             !ishex(cp[2]) || !ishex(cp[3]) || !isblank(cp[4]) )  <span class="keywordflow">return</span> false ;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="comment">// We will use cp to traverse the string</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    cp = s;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="comment">// Check mode = Oscillated/Learned</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    byp(&amp;cp);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">if</span> (htow(cp) != 0000)  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    cp += 4;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="comment">// Extract &amp; set frequency</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    byp(&amp;cp);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    freq = (int)(1000000 / (htow(cp) * 0.241246));  <span class="comment">// Rounding errors will occur, tolerance is +/- 10%</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    usec = (int)(((1.0 / freq) * 1000000) + 0.5);  <span class="comment">// Another rounding error, thank Cod for analogue electronics</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    freq /= 1000;  <span class="comment">// This will introduce a(nother) rounding error which we do not want in the usec calcualtion</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    cp += 4;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="comment">// Get length of &quot;once&quot; code</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    byp(&amp;cp);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    once = htow(cp);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    cp += 4;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="comment">// Get length of &quot;repeat&quot; code</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    byp(&amp;cp);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    rpt = htow(cp);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    cp += 4;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="comment">// Which code are we sending?</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordflow">if</span> (fallback) { <span class="comment">// fallback on the &quot;other&quot; code if &quot;this&quot; code is not present</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="keywordflow">if</span> (!repeat) { <span class="comment">// requested &#39;once&#39;</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            <span class="keywordflow">if</span> (once)  len = once * 2,  skip = 0 ;  <span class="comment">// if once exists send it</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            <span class="keywordflow">else</span>       len = rpt  * 2,  skip = 0 ;  <span class="comment">// else send repeat code</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        } <span class="keywordflow">else</span> { <span class="comment">// requested &#39;repeat&#39;</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            <span class="keywordflow">if</span> (rpt)   len = rpt  * 2,  skip = 0 ;  <span class="comment">// if rpt exists send it</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            <span class="keywordflow">else</span>       len = once * 2,  skip = 0 ;  <span class="comment">// else send once code</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        }</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    } <span class="keywordflow">else</span> {  <span class="comment">// Send what we asked for, do not fallback if the code is empty!</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="keywordflow">if</span> (!repeat)  len = once * 2,  skip = 0 ;     <span class="comment">// &#39;once&#39; starts at 0</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="keywordflow">else</span>          len = rpt  * 2,  skip = once ;  <span class="comment">// &#39;repeat&#39; starts where &#39;once&#39; ends</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment">// Skip to start of code</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordflow">for</span> (i = 0;  i &lt; skip;  i++, cp += 4)  byp(&amp;cp) ;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="comment">// Send code</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    enableIROut(freq);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordflow">for</span> (i = 0;  i &lt; len;  i++) {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        byp(&amp;cp);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="keywordflow">if</span> (i &amp; 1)  space(htow(cp) * usec);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="keywordflow">else</span>        mark (htow(cp) * usec);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        cp += 4;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    }</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;}</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">//+=============================================================================</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="preprocessor">#if TEST</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="keywordtype">int</span>  main ( )</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;{</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordtype">char</span>  prontoTest[] =</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="stringliteral">&quot;0000 0070 0000 0032 0080 0040 0010 0010 0010 0030 &quot;</span> <span class="comment">//  10</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="stringliteral">&quot;0010 0010 0010 0010 0010 0010 0010 0010 0010 0010 &quot;</span> <span class="comment">//  20</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="stringliteral">&quot;0010 0010 0010 0010 0010 0010 0010 0010 0010 0010 &quot;</span> <span class="comment">//  30</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="stringliteral">&quot;0010 0010 0010 0030 0010 0010 0010 0010 0010 0010 &quot;</span> <span class="comment">//  40</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="stringliteral">&quot;0010 0010 0010 0010 0010 0010 0010 0010 0010 0010 &quot;</span> <span class="comment">//  50</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="stringliteral">&quot;0010 0010 0010 0030 0010 0010 0010 0010 0010 0010 &quot;</span> <span class="comment">//  60</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="stringliteral">&quot;0010 0010 0010 0010 0010 0010 0010 0010 0010 0010 &quot;</span> <span class="comment">//  70</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="stringliteral">&quot;0010 0010 0010 0030 0010 0010 0010 0030 0010 0010 &quot;</span> <span class="comment">//  80</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="stringliteral">&quot;0010 0010 0010 0030 0010 0010 0010 0010 0010 0030 &quot;</span> <span class="comment">//  90</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="stringliteral">&quot;0010 0010 0010 0030 0010 0010 0010 0010 0010 0030 &quot;</span> <span class="comment">// 100</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="stringliteral">&quot;0010 0030 0010 0aa6&quot;</span>;                               <span class="comment">// 104</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    sendPronto(prontoTest, <a class="code" href="IRremote_8h.html#a54baac74d0d2d3c960f440eee15ab589">PRONTO_ONCE</a>,   <a class="code" href="IRremote_8h.html#acca40cd6c70d887fa4af511dd426b80c">PRONTO_FALLBACK</a>);    <span class="comment">// once code</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    sendPronto(prontoTest, <a class="code" href="IRremote_8h.html#a8c7930c34825a4c69523e7e2ba840d50">PRONTO_REPEAT</a>, <a class="code" href="IRremote_8h.html#acca40cd6c70d887fa4af511dd426b80c">PRONTO_FALLBACK</a>);    <span class="comment">// repeat code</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    sendPronto(prontoTest, <a class="code" href="IRremote_8h.html#a54baac74d0d2d3c960f440eee15ab589">PRONTO_ONCE</a>,   <a class="code" href="IRremote_8h.html#aafa6228b1f965750fd4837f08258e234">PRONTO_NOFALLBACK</a>);  <span class="comment">// once code</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    sendPronto(prontoTest, <a class="code" href="IRremote_8h.html#a8c7930c34825a4c69523e7e2ba840d50">PRONTO_REPEAT</a>, <a class="code" href="IRremote_8h.html#aafa6228b1f965750fd4837f08258e234">PRONTO_NOFALLBACK</a>);  <span class="comment">// repeat code</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;}</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="preprocessor">#endif // TEST</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="preprocessor">#endif // SEND_PRONTO</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160; </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">//******************************************************************************</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">// Sources:</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">//   http://www.remotecentral.com/features/irdisp2.htm</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">//   http://www.hifi-remote.com/wiki/index.php?title=Working_With_Pronto_Hex</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">//******************************************************************************</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="preprocessor">#include &lt;stdint.h&gt;</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="preprocessor">#define IRPRONTO</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IRremoteInt_8h.html">IRremoteInt.h</a>&quot;</span>  <span class="comment">// The Arduino IRremote library defines USECPERTICK</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">// Source: https://www.google.co.uk/search?q=DENON+MASTER+IR+Hex+Command+Sheet</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">//         -&gt; http://assets.denon.com/documentmaster/us/denon%20master%20ir%20hex.xls</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="keywordtype">char</span>  prontoTest[] =</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="stringliteral">&quot;0000 0070 0000 0032 0080 0040 0010 0010 0010 0030 &quot;</span> <span class="comment">//  10</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="stringliteral">&quot;0010 0010 0010 0010 0010 0010 0010 0010 0010 0010 &quot;</span> <span class="comment">//  20</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="stringliteral">&quot;0010 0010 0010 0010 0010 0010 0010 0010 0010 0010 &quot;</span> <span class="comment">//  30</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="stringliteral">&quot;0010 0010 0010 0030 0010 0010 0010 0010 0010 0010 &quot;</span> <span class="comment">//  40</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="stringliteral">&quot;0010 0010 0010 0010 0010 0010 0010 0010 0010 0010 &quot;</span> <span class="comment">//  50</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="stringliteral">&quot;0010 0010 0010 0030 0010 0010 0010 0010 0010 0010 &quot;</span> <span class="comment">//  60</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="stringliteral">&quot;0010 0010 0010 0010 0010 0010 0010 0010 0010 0010 &quot;</span> <span class="comment">//  70</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="stringliteral">&quot;0010 0010 0010 0030 0010 0010 0010 0030 0010 0010 &quot;</span> <span class="comment">//  80</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="stringliteral">&quot;0010 0010 0010 0030 0010 0010 0010 0010 0010 0030 &quot;</span> <span class="comment">//  90</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="stringliteral">&quot;0010 0010 0010 0030 0010 0010 0010 0010 0010 0030 &quot;</span> <span class="comment">// 100</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="stringliteral">&quot;0010 0030 0010 0aa6&quot;</span>;                               <span class="comment">// 104</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">// This is the longest code we can support</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="preprocessor">#define CODEMAX  200</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">// This is the data we pull out of the pronto code</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="keyword">typedef</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <span class="keywordtype">int</span>        freq;           <span class="comment">// Carrier frequency (in Hz)</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="keywordtype">int</span>        usec;           <span class="comment">// uSec per tick (based on freq)</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="keywordtype">int</span>        codeLen;        <span class="comment">// Length of code</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        uint16_t   <a class="code" href="LICENSE_8txt.html#afa2765f9f647ea2e9c46055f93a44d41">code</a>[CODEMAX];  <span class="comment">// Code in hex</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="keywordtype">int</span>        onceLen;        <span class="comment">// Length of &quot;once&quot; transmit</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        uint16_t*  once;           <span class="comment">// Pointer to start within &#39;code&#39;</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="keywordtype">int</span>        rptLen;         <span class="comment">// Length of &quot;repeat&quot; transmit</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        uint16_t*  rpt;            <span class="comment">// Pointer to start within &#39;code&#39;</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    }</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;pronto_t;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">// From what I have seen, the only time we go over 8-bits is the &#39;space&#39;</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">// on the end which creates the lead-out/inter-code gap.  Assuming I&#39;m right,</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">// we can code this up as a special case and otherwise halve the size of our</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">// data!</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">// Ignoring the first four values (the config data) and the last value</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">// (the lead-out), if you find a protocol that uses values greater than 00fe</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">// we are going to have to revisit this code!</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">// So, the 0th byte will be the carrier frequency in Khz (NOT Hz)</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">//      &quot;  1st  &quot;    &quot;   &quot;   &quot;  length of the &quot;once&quot; code</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">//      &quot;  2nd  &quot;    &quot;   &quot;   &quot;  length of the &quot;repeat&quot; code</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">// Thereafter, odd  bytes will be Mark  lengths as a multiple of USECPERTICK uS</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">//             even   &quot;     &quot;  &quot;  Space    &quot;    &quot;  &quot;    &quot;     &quot;       &quot;      &quot;</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">// Any occurence of &quot;FF&quot; in either a Mark or a Space will indicate</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">//   &quot;Use the 16-bit FF value&quot; which will also be a multiple of USECPERTICK uS</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">// As a point of comparison, the test code (prontoTest[]) is 520 bytes</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">// (yes, more than 0.5KB of our Arduino&#39;s precious 32KB) ... after conversion</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">// to pronto hex that goes down to ((520/5)*2) = 208 bytes ... once converted to</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">// our format we are down to ((208/2) -1 -1 +2) = 104 bytes</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">// In fariness this is still very memory-hungry</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">// ...As a rough guide:</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">//   10 codes cost 1K of memory (this will vary depending on the protocol).</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">// So if you&#39;re building a complex remote control, you will probably need to</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">// keep the codes on an external memory device (not in the Arduino sketch) and</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">// load them as you need them.  Hmmm.</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">// This dictates that &quot;Oscillated Pronto Codes&quot; are probably NOT the way forward</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">// For example, prontoTest[] happens to be: A 48-bit IR code in Denon format</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">// So we know it starts with 80/40                           (Denon header)</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">//             and ends with 10/aa6                          (Denon leadout)</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">//             and all (48) bits in between are either 10/10 (Denon 0)</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">//                                                  or 10/30 (Denon 1)</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">// So we could easily store this data in 1-byte  (&quot;Denon&quot;)</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">//                                     + 1-byte  (Length=48)</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">//                                     + 6-bytes (IR code)</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">// At 8-bytes per code, we can store 128 codes in 1KB or memory - that&#39;s a lot</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">// better than the 2 (two) we started off with!</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">// And serendipitously, by reducing the amount of data, our program will run</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">// a LOT faster!</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">// Again, I repeat, even after you have spent time converting the &quot;Oscillated</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">// Pronto Codes&quot; in to IRremote format, it will be a LOT more memory-hungry</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">// than using sendDenon() (or whichever) ...BUT these codes are easily</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">// available on the internet, so we&#39;ll support them!</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="keyword">typedef</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        uint16_t   FF;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        uint8_t    <a class="code" href="LICENSE_8txt.html#afa2765f9f647ea2e9c46055f93a44d41">code</a>[CODEMAX];</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    }</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;irCode_t;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="preprocessor">#define DEBUGF(...)  printf(__VA_ARGS__)</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">//+=============================================================================</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">// String must be block of 4 hex digits separated with blanks</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="keywordtype">bool</span>  validate (<span class="keywordtype">char</span>* cp,  <span class="keywordtype">int</span>* len)</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;{</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordflow">for</span> (*len = 0;  *cp;  (*len)++, cp += 4) {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        byp(&amp;cp);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <span class="keywordflow">if</span> ( !ishex(cp[0]) || !ishex(cp[1]) ||</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;             !ishex(cp[2]) || !ishex(cp[3]) || !isblank(cp[4]) )  <span class="keywordflow">return</span> false ;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    }</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;}</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">//+=============================================================================</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">// Hex-to-Byte : Decode a hex digit</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">// We assume the character has already been validated</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;uint8_t  htob (<span class="keywordtype">char</span> ch)</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;{</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordflow">if</span> ((ch &gt;= <span class="charliteral">&#39;0&#39;</span>) &amp;&amp; (ch &lt;= <span class="charliteral">&#39;9&#39;</span>))  <span class="keywordflow">return</span> ch - <span class="charliteral">&#39;0&#39;</span> ;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keywordflow">if</span> ((ch &gt;= <span class="charliteral">&#39;A&#39;</span>) &amp;&amp; (ch &lt;= <span class="charliteral">&#39;F&#39;</span>))  <span class="keywordflow">return</span> ch - <span class="charliteral">&#39;A&#39;</span> + 10 ;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keywordflow">if</span> ((ch &gt;= <span class="charliteral">&#39;a&#39;</span>) &amp;&amp; (ch &lt;= <span class="charliteral">&#39;f&#39;</span>))  <span class="keywordflow">return</span> ch - <span class="charliteral">&#39;a&#39;</span> + 10 ;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;}</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160; </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">//+=============================================================================</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">// Hex-to-Word : Decode a block of 4 hex digits</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">// We assume the string has already been validated</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">//   and the pointer being passed points at the start of a block of 4 hex digits</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;uint16_t  htow (<span class="keywordtype">char</span>* cp)</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;{</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordflow">return</span> ( (htob(cp[0]) &lt;&lt; 12) | (htob(cp[1]) &lt;&lt;  8) |</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;             (htob(cp[2]) &lt;&lt;  4) | (htob(cp[3])      )  ) ;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;}</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160; </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">//+=============================================================================</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">// Convert the pronto string in to data</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="keywordtype">bool</span>  decode (<span class="keywordtype">char</span>* s,  pronto_t* p,  irCode_t* ir)</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;{</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordtype">int</span>    i, len;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="keywordtype">char</span>*  cp;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="comment">// Validate the Pronto string</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordflow">if</span> (!validate(s, &amp;p-&gt;codeLen)) {</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        DEBUGF(<span class="stringliteral">&quot;Invalid pronto string\n&quot;</span>);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="keywordflow">return</span> false ;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    }</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    DEBUGF(<span class="stringliteral">&quot;Found %d hex codes\n&quot;</span>, p-&gt;codeLen);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="comment">// Allocate memory to store the decoded string</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="comment">//if (!(p-&gt;code = malloc(p-&gt;len))) {</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="comment">//  DEBUGF(&quot;Memory allocation failed\n&quot;);</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="comment">//  return false ;</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="comment">//}</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="comment">// Check in case our code is too long</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="keywordflow">if</span> (p-&gt;codeLen &gt; CODEMAX) {</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        DEBUGF(<span class="stringliteral">&quot;Code too long, edit CODEMAX and recompile\n&quot;</span>);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <span class="keywordflow">return</span> false ;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    }</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="comment">// Decode the string</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    cp = s;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keywordflow">for</span> (i = 0;  i &lt; p-&gt;codeLen;  i++, cp += 4) {</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        byp(&amp;cp);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        p-&gt;code[i] = htow(cp);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    }</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="comment">// Announce our findings</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    DEBUGF(<span class="stringliteral">&quot;Input: |%s|\n&quot;</span>, s);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    DEBUGF(<span class="stringliteral">&quot;Found: |&quot;</span>);</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keywordflow">for</span> (i = 0;  i &lt; p-&gt;codeLen;  i++)  DEBUGF(<span class="stringliteral">&quot;%04x &quot;</span>, p-&gt;code[i]) ;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    DEBUGF(<span class="stringliteral">&quot;|\n&quot;</span>);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160; </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    DEBUGF(<span class="stringliteral">&quot;Form [%04X] : &quot;</span>, p-&gt;code[0]);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordflow">if</span>      (p-&gt;code[0] == 0x0000)  DEBUGF(<span class="stringliteral">&quot;Oscillated (Learned)\n&quot;</span>);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (p-&gt;code[0] == 0x0100)  DEBUGF(<span class="stringliteral">&quot;Unmodulated\n&quot;</span>);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keywordflow">else</span>                            DEBUGF(<span class="stringliteral">&quot;Unknown\n&quot;</span>);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keywordflow">if</span> (p-&gt;code[0] != 0x0000)  <span class="keywordflow">return</span> false ;  <span class="comment">// Can only handle Oscillated</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="comment">// Calculate the carrier frequency (+/- 10%) &amp; uSecs per pulse</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="comment">// Pronto uses a crystal which generates a timeabse of 0.241246</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    p-&gt;freq     = (int)(1000000 / (p-&gt;code[1] * 0.241246));</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    p-&gt;usec     = (int)(((1.0 / p-&gt;freq) * 1000000) + 0.5);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    ir-&gt;code[0] = p-&gt;freq / 1000;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    DEBUGF(<span class="stringliteral">&quot;Freq [%04X] : %d Hz  (%d uS/pluse) -&gt; %d KHz\n&quot;</span>,</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;           p-&gt;code[1], p-&gt;freq, p-&gt;usec, ir-&gt;code[0]);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160; </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="comment">// Set the length &amp; start pointer for the &quot;once&quot; code</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    p-&gt;onceLen  = p-&gt;code[2];</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    p-&gt;once     = &amp;p-&gt;code[4];</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    ir-&gt;code[1] = p-&gt;onceLen;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    DEBUGF(<span class="stringliteral">&quot;Once [%04X] : %d\n&quot;</span>, p-&gt;code[2], p-&gt;onceLen);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="comment">// Set the length &amp; start pointer for the &quot;repeat&quot; code</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    p-&gt;rptLen = p-&gt;code[3];</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    p-&gt;rpt    = &amp;p-&gt;code[4 + p-&gt;onceLen];</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    ir-&gt;code[2] = p-&gt;rptLen;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    DEBUGF(<span class="stringliteral">&quot;Rpt  [%04X] : %d\n&quot;</span>, p-&gt;code[3], p-&gt;rptLen);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160; </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="comment">// Check everything tallies</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="keywordflow">if</span> (1 + 1 + 1 + 1 + (p-&gt;onceLen * 2) + (p-&gt;rptLen * 2) != p-&gt;codeLen) {</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        DEBUGF(<span class="stringliteral">&quot;Bad code length\n&quot;</span>);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    }</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160; </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="comment">// Convert the IR data to our new format</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    ir-&gt;FF = p-&gt;code[p-&gt;codeLen - 1];</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160; </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    len = (p-&gt;onceLen * 2) + (p-&gt;rptLen * 2);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    DEBUGF(<span class="stringliteral">&quot;Encoded: |&quot;</span>);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordflow">for</span> (i = 0;  i &lt; len;  i++) {</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <span class="keywordflow">if</span> (p-&gt;code[i+4] == ir-&gt;FF) {</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;            ir-&gt;code[i+3] = 0xFF;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (p-&gt;code[i+4] &gt; 0xFE) {</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;            DEBUGF(<span class="stringliteral">&quot;\n%04X : Mark/Space overflow\n&quot;</span>, p-&gt;code[i+4]);</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;            ir-&gt;code[i+3] = (p-&gt;code[i+4] * p-&gt;usec) / <a class="code" href="boarddefs_8h.html#aad2fcaac88c28bf54ecbd42146a56e3f">USECPERTICK</a>;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        }</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        DEBUGF(<span class="stringliteral">&quot;%s%d&quot;</span>, !i ? <span class="stringliteral">&quot;&quot;</span> : (i&amp;1 ? <span class="stringliteral">&quot;,&quot;</span> : <span class="stringliteral">&quot;, &quot;</span>), ir-&gt;code[i+3]);</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    }</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    DEBUGF(<span class="stringliteral">&quot;|\n&quot;</span>);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160; </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    ir-&gt;FF = (ir-&gt;FF * p-&gt;usec) / <a class="code" href="boarddefs_8h.html#aad2fcaac88c28bf54ecbd42146a56e3f">USECPERTICK</a>;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    DEBUGF(<span class="stringliteral">&quot;FF -&gt; %d\n&quot;</span>, ir-&gt;FF);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160; </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;}</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160; </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">//+=============================================================================</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="keywordtype">void</span>  irDump (irCode_t* ir)</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;{</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="keywordtype">int</span>  i, len;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160; </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    printf(<span class="stringliteral">&quot;uint8_t  buttonName[%d] = {&quot;</span>, len);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160; </div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    printf(<span class="stringliteral">&quot;%d,%d, &quot;</span>, (ir-&gt;FF &gt;&gt; 8), ir-&gt;FF &amp; 0xFF);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    printf(<span class="stringliteral">&quot;%d,%d,%d, &quot;</span>, ir-&gt;code[0], ir-&gt;code[1], ir-&gt;code[2]);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160; </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    len = (ir-&gt;code[1] * 2) + (ir-&gt;code[2] * 2);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="keywordflow">for</span> (i = 0;  i &lt; len;  i++) {</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        printf(<span class="stringliteral">&quot;%s%d&quot;</span>, !i ? <span class="stringliteral">&quot;&quot;</span> : (i&amp;1 ? <span class="stringliteral">&quot;,&quot;</span> : <span class="stringliteral">&quot;, &quot;</span>), ir-&gt;code[i+3]);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    }</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    printf(<span class="stringliteral">&quot;};\n&quot;</span>);</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160; </div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;}</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160; </div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">//+=============================================================================</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="keywordtype">int</span>  main ( )</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;{</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    pronto_t  pCode;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    irCode_t  irCode;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160; </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    decode(prontoTest, &amp;pCode, &amp;irCode);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160; </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    irDump(&amp;irCode);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160; </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;}</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160; </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="preprocessor">#endif //0</span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aIRremote_8h_html_aafa6228b1f965750fd4837f08258e234"><div class="ttname"><a href="IRremote_8h.html#aafa6228b1f965750fd4837f08258e234">PRONTO_NOFALLBACK</a></div><div class="ttdeci">#define PRONTO_NOFALLBACK</div><div class="ttdef"><b>Definition:</b> <a href="IRremote_8h_source.html#l00099">IRremote.h:99</a></div></div>
<div class="ttc" id="aLICENSE_8txt_html_afa2765f9f647ea2e9c46055f93a44d41"><div class="ttname"><a href="LICENSE_8txt.html#afa2765f9f647ea2e9c46055f93a44d41">code</a></div><div class="ttdeci">the intent is to exercise the right to control the distribution of derivative or collective works based on the Library In mere aggregation of another work not based on the Library with the you must alter all the notices that refer to this so that they refer to the ordinary GNU General Public instead of to this it is irreversible for that so the ordinary GNU General Public License applies to all subsequent copies and derivative works made from that copy This option is useful when you wish to copy part of the code of the Library into a program that is not a library You may copy and distribute the which must be distributed under the terms of Sections and above on a medium customarily used for software interchange If distribution of object code is made by offering access to copy from a designated then offering equivalent access to copy the source code from the same place satisfies the requirement to distribute the source code</div><div class="ttdef"><b>Definition:</b> <a href="LICENSE_8txt_source.html#l00238">LICENSE.txt:238</a></div></div>
<div class="ttc" id="aIRremote_8h_html_a8c7930c34825a4c69523e7e2ba840d50"><div class="ttname"><a href="IRremote_8h.html#a8c7930c34825a4c69523e7e2ba840d50">PRONTO_REPEAT</a></div><div class="ttdeci">#define PRONTO_REPEAT</div><div class="ttdef"><b>Definition:</b> <a href="IRremote_8h_source.html#l00097">IRremote.h:97</a></div></div>
<div class="ttc" id="aIRremote_8h_html"><div class="ttname"><a href="IRremote_8h.html">IRremote.h</a></div><div class="ttdoc">Public API to the library.</div></div>
<div class="ttc" id="aIRremote_8h_html_a54baac74d0d2d3c960f440eee15ab589"><div class="ttname"><a href="IRremote_8h.html#a54baac74d0d2d3c960f440eee15ab589">PRONTO_ONCE</a></div><div class="ttdeci">#define PRONTO_ONCE</div><div class="ttdef"><b>Definition:</b> <a href="IRremote_8h_source.html#l00096">IRremote.h:96</a></div></div>
<div class="ttc" id="aboarddefs_8h_html_aad2fcaac88c28bf54ecbd42146a56e3f"><div class="ttname"><a href="boarddefs_8h.html#aad2fcaac88c28bf54ecbd42146a56e3f">USECPERTICK</a></div><div class="ttdeci">#define USECPERTICK</div><div class="ttdef"><b>Definition:</b> <a href="boarddefs_8h_source.html#l00111">boarddefs.h:111</a></div></div>
<div class="ttc" id="aIRremote_8h_html_acca40cd6c70d887fa4af511dd426b80c"><div class="ttname"><a href="IRremote_8h.html#acca40cd6c70d887fa4af511dd426b80c">PRONTO_FALLBACK</a></div><div class="ttdeci">#define PRONTO_FALLBACK</div><div class="ttdef"><b>Definition:</b> <a href="IRremote_8h_source.html#l00098">IRremote.h:98</a></div></div>
<div class="ttc" id="aIRremoteInt_8h_html"><div class="ttname"><a href="IRremoteInt_8h.html">IRremoteInt.h</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Jun 17 2020 12:35:54 for IRremote by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
